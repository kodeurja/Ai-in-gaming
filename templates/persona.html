{% extends "layout.html" %}
{% block content %}
<div class="persona-container">
    <h2>Create Your Persona</h2>
    <div class="persona-builder">
        <div class="preview-section">
            <div class="avatar-placeholder">
                <img src="https://api.dicebear.com/9.x/avataaars/svg?seed={{ current_user.username }}"
                    alt="Avatar Preview" id="avatar-preview">
            </div>
        </div>
        <div class="controls-section">
            <form action="{{ url_for('create_persona') }}" method="POST">
                <div class="form-group">
                    <label>Agent Name</label>
                    <input type="text" name="name" value="{{ current_user.username }}" required>
                </div>

                <div class="form-group">
                    <label>Style</label>
                    <select name="style" id="style-select" onchange="updatePreview()">
                        <option value="adventurer">Adventurer</option>
                        <option value="cyberpunk">Cyberpunk</option>
                        <option value="noir">Noir Detective</option>
                    </select>
                </div>

                <!-- Simple visual attributes -->
                <div class="form-group">
                    <label>Gender</label>
                    <select name="gender">
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="non-binary">Non-binary</option>
                    </select>
                </div>

                <button type="submit" class="btn-primary">Initialize Persona</button>
            </form>
        </div>
    </div>
</div>

<script>
    function updatePreview() {
        // Simple logic to trigger a re-render or change visual style
        // For now, we rely on DiceBear which is random/seed based, 
        // but we could append params to url to change it.
        const seed = document.querySelector('input[name="name"]').value;
        document.getElementById('avatar-preview').src = `https://api.dicebear.com/9.x/avataaars/svg?seed=${seed}`;
    }
</script>

<style>
    .persona-builder {
        display: flex;
        gap: 40px;
        background: var(--card-bg);
        padding: 30px;
        border-radius: 12px;
    }

    .preview-section {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .controls-section {
        flex: 1;
    }

    .avatar-placeholder img {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        border: 4px solid var(--accent);
    }
</style>
{% endblock %}